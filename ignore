## 2. 界面布局架构

系统采用三栏式经典布局，确保信息流的高效传递：

* **左侧 (Navigation Area):** 系统的基础菜单栏，主要展示用户开启的对话 Session，在下方可以有当前登录用户的信息，系统设置等按钮。
* **中间 (Main UI Canvas):** 动态生成区域。根据 AI 指令展示当前的业务表单、图表或操作界面。
* **右侧 (AI Assistant Panel):** 聊天窗口。用户输入原始需求，AI 反馈当前步骤、指引建议及处理状态。

---

## 3. 核心功能需求

### 3.1 意图识别与任务拆解

* **语义分析：** AI 需识别用户在聊天框输入的自然语言（例：“我要完成 A 业务的第 4 项功能”）。
* **依赖检索：** 后端根据业务逻辑库，自动分析出完成目标功能所需的**前置条件**（如 A4 依赖 A1  A2  A3）。

### 3.2 动态 UI 生成与注入

* **上下文感知渲染：** UI 并非一次性生成，而是根据当前任务节点（A1, A2...）动态渲染。
* **状态保持：** 页面需保留已完成步骤的数据上下文，供后续步骤调用。

### 3.3 “阻塞-唤醒”工作流机制 (Human-in-the-loop)

* **逻辑挂起：** 当流程运行到需要用户输入的节点（如 A1 表单）时，后端工作流进入 `WAITING` 状态。
* **事件驱动唤醒：** 用户点击“提交”后，前端触发 Hook 信号，唤醒后端 Agent 继续执行下一步。

### 3.4 协同反馈

* **侧边栏联动：** 每一个 UI 动作（如提交 A1）后，右侧聊天框需同步更新状态（例：“A1 已完成，正在为您准备 A2 的配置环境...”）。

---

## 4. 业务场景示例：完成功能 A4

1. 把原子业务封装成独立的 Skill，每一份 Skill 都是一套独立的原子性的组件，其中包含具体执行业务的函数，预设好的组件模板
   1. 技能定义： 你预先定义好 Skill_A1（基础信息收集）、Skill_A2（参数配置）等。
   2. 技能调用： 当 Agent 判断用户想做 A4 时，它会查阅技能书，发现依赖 A1。于是它调用 Skill_A1。
   3. UI 触达： 调用 Skill_A1 的结果不是一段文字，而是一个 JSON Schema。前端收到后，从积木库里掏出对应的组件拼装。
2. AI 需要判断，当前该用户想要完成 A4 功能，都需要完成哪些业务。并不是每个用户想要完成 A4 功能，都需要完成 A1，A2，A3。部分用户可能仅需要完成A1，A3，部分用户可能仅需完成 A1，即可完成A4 的功能。
   1. 你需要设计如何完成这个前置状态检查功能。
   2. 明确动态拓扑排序和数据竞争的实现。

| 阶段 | AI 行为 (右侧) | UI 行为 (中间) | 用户操作 |
| --- | --- | --- | --- |
| **1. 需求识别** | 确认目标：完成 A4。告知用户需要先完成 A1/2/3。 | 加载中动画... | 输入需求 |
| **2. 执行 A1** | 提示：“请填写 A1 基础信息表单”。 | **生成 A1 表单** | 填写并点击提交 |
| **3. 逻辑流转** | 校验 A1 数据，提示：“正在跳转至 A2 安全设置”。 | **销毁 A1，生成 A2 界面** | 交互操作 |
| **4. 最终达成** | 提示：“所有前置任务已完成，A4 业务已处理完毕”。 | **展示 A4 结果页** | 查阅结果 |

---

